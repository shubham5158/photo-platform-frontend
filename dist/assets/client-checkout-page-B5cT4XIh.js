import{e as v,b as y,a as P,r as a,j as e,z as c}from"./index-BZrbO6AC.js";import{a as N}from"./Gallery-UStUwLWL.js";import{c as w}from"./Orders-BmzgaHfV.js";import{t as x,a as n}from"./toast-BHgV-WJb.js";const A=()=>{const{code:r}=v(),p=y(),d=P(),t=p.state?.selectedIds||[],[s,b]=a.useState(null),[o,f]=a.useState(""),[g,h]=a.useState(!0),[m,C]=a.useState(!1);a.useEffect(()=>{if(!t.length){d(`/g/${r}`);return}(async()=>{try{const l=await N(r,t);b(l),x("Price loaded")}catch{n("Could not load price")}finally{h(!1)}})()},[r,t]);const j=async i=>{if(i.preventDefault(),!o)return n("Email required");const l=c.loading("Creating order...");try{const u=await w(r,t,o);c.dismiss(l),x("Order created!"),d(`/download/${u.downloadToken}`,{state:{orderId:u.orderId}})}catch{c.dismiss(l),n("Order failed")}};return g?e.jsx("div",{className:"min-h-screen flex items-center justify-center text-slate-50",children:"Calculating price..."}):e.jsx("div",{className:"min-h-screen bg-slate-950 text-slate-50 flex justify-center items-center px-4",children:e.jsxs("div",{className:"bg-slate-900/80 border border-slate-700 p-6 rounded-xl max-w-lg w-full",children:[e.jsx("h1",{className:"text-xl font-semibold mb-3",children:"Checkout"}),e.jsxs("p",{className:"text-sm text-slate-300 mb-4",children:["You selected ",t.length," photos."]}),s&&e.jsxs("div",{className:"bg-slate-900 border border-slate-700 rounded-lg p-3 text-sm space-y-1",children:[e.jsxs("div",{children:["Base price: ₹",s.basePrice]}),e.jsxs("div",{children:["Gross: ₹",s.gross]}),e.jsxs("div",{children:["Discount: ",s.discountPercent,"% (₹",s.discountAmount,")"]}),e.jsxs("div",{className:"font-semibold text-amber-300",children:["Total: ₹",s.net]})]}),e.jsxs("form",{className:"space-y-3 mt-4",onSubmit:j,children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm",children:"Your Email"}),e.jsx("input",{type:"email",className:"w-full px-3 py-2 bg-slate-900 border border-slate-700 rounded text-sm",value:o,onChange:i=>f(i.target.value),placeholder:"you@example.com"})]}),e.jsx("button",{disabled:m,className:"w-full bg-amber-400 text-slate-900 py-2 rounded font-semibold",children:m?"Processing...":"Confirm & Get Download Link"})]})]})})};export{A as default};
